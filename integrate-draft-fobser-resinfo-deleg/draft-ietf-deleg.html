<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Extensible Delegation for DNS</title>
<meta content="Tim April" name="author">
<meta content="Petr Špaček" name="author">
<meta content="Ralf Weber" name="author">
<meta content="David C Lawrence" name="author">
<meta content="
       This document proposes a new extensible method for the delegation of authority for a domain in the Domain Name System (DNS) using DELEG and DELEGI records. 
       A delegation in the DNS enables efficient and distributed management of the DNS namespace.
The traditional DNS delegation is based on NS records which contain only hostnames of servers and no other parameters.
The new delegation records are extensible, can be secured with DNSSEC, and eliminate the problem of having two sources of truth for delegation information. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="DNS" name="keyword">
<meta content="delegation" name="keyword">
<meta content="draft-ietf-deleg-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.5.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    wcwidth 0.2.14
-->
<link href="draft-ietf-deleg.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">DELEG</td>
<td class="right">October 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">April, et al.</td>
<td class="center">Expires 23 April 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">deleg</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-deleg-latest</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc1034" class="eref">1034</a>, <a href="https://www.rfc-editor.org/rfc/rfc1035" class="eref">1035</a>, <a href="https://www.rfc-editor.org/rfc/rfc4035" class="eref">4035</a>, <a href="https://www.rfc-editor.org/rfc/rfc6672" class="eref">6672</a>, <a href="https://www.rfc-editor.org/rfc/rfc6840" class="eref">6840</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-10-20" class="published">20 October 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-04-23">23 April 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. April</div>
<div class="org">Google, LLC</div>
</div>
<div class="author">
      <div class="author-name">P. Špaček</div>
<div class="org">ISC</div>
</div>
<div class="author">
      <div class="author-name">R. Weber</div>
<div class="org">Akamai Technologies</div>
</div>
<div class="author">
      <div class="author-name">D. Lawrence</div>
<div class="org">Salesforce</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Extensible Delegation for DNS</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document proposes a new extensible method for the delegation of authority for a domain in the Domain Name System (DNS) using DELEG and DELEGI records.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">A delegation in the DNS enables efficient and distributed management of the DNS namespace.
The traditional DNS delegation is based on NS records which contain only hostnames of servers and no other parameters.
The new delegation records are extensible, can be secured with DNSSEC, and eliminate the problem of having two sources of truth for delegation information.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://github.com/ietf-wg-deleg/draft-ietf-deleg-base/tree/gh-pages">https://github.com/ietf-wg-deleg/draft-ietf-deleg-base/tree/gh-pages</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-deleg/">https://datatracker.ietf.org/doc/draft-ietf-deleg/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        deleg Working Group mailing list (<span><a href="mailto:dd@ietf.org">mailto:dd@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/dd/">https://mailarchive.ietf.org/arch/browse/dd/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/dd/">https://www.ietf.org/mailman/listinfo/dd/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/ietf-wg-deleg/draft-ietf-deleg-base/">https://github.com/ietf-wg-deleg/draft-ietf-deleg-base/</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 23 April 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-deleg-and-delegi-resource-r" class="internal xref">DELEG and DELEGI Resource Record Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-presentation-format" class="internal xref">Presentation Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-rdata-wire-format" class="internal xref">RDATA Wire Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-overview-of-differences-bet" class="internal xref">Overview of Differences between DELEG and DELEGI Semantics</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-use-of-deleg-records" class="internal xref">Use of DELEG Records</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-resolvers" class="internal xref">Resolvers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-signaling-deleg-support" class="internal xref">Signaling DELEG Support</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="auto internal xref">3.1.2</a>.  <a href="#name-referral" class="internal xref">Referral</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="auto internal xref">3.1.3</a>.  <a href="#name-parent-side-types-qtypedele" class="internal xref">Parent-side types, QTYPE=DELEG</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.4">
                    <p id="section-toc.1-1.3.2.1.2.4.1"><a href="#section-3.1.4" class="auto internal xref">3.1.4</a>.  <a href="#name-algorithm-for-finding-the-b" class="internal xref">Algorithm for "Finding the Best Servers to Ask"</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.5">
                    <p id="section-toc.1-1.3.2.1.2.5.1"><a href="#section-3.1.5" class="auto internal xref">3.1.5</a>.  <a href="#name-name-server-information-for" class="internal xref">Name Server Information for Delegation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.6">
                    <p id="section-toc.1-1.3.2.1.2.6.1"><a href="#section-3.1.6" class="auto internal xref">3.1.6</a>.  <a href="#name-populating-the-slist-from-d" class="internal xref">Populating the SLIST from DELEG and DELEGI Records</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-authoritative-servers" class="internal xref">Authoritative Servers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-deleg-aware-clients" class="internal xref">DELEG-aware Clients</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-deleg-unaware-clients" class="internal xref">DELEG-unaware Clients</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-dnssec-signers" class="internal xref">DNSSEC Signers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-dnssec-validators" class="internal xref">DNSSEC Validators</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="auto internal xref">3.4.1</a>.  <a href="#name-clarifications-on-nonexiste" class="internal xref">Clarifications on Nonexistence Proofs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="auto internal xref">3.4.2</a>.  <a href="#name-insecure-delegation-proofs" class="internal xref">Insecure Delegation Proofs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="auto internal xref">3.4.3</a>.  <a href="#name-referral-downgrade-protecti" class="internal xref">Referral downgrade protection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.4">
                    <p id="section-toc.1-1.3.2.4.2.4.1"><a href="#section-3.4.4" class="auto internal xref">3.4.4</a>.  <a href="#name-chaining" class="internal xref">Chaining</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-preventing-over-work-attack" class="internal xref">Preventing Over-work Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-preventing-downgrade-attack" class="internal xref">Preventing Downgrade Attacks</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-changes-to-existing-registr" class="internal xref">Changes to Existing Registries</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-new-registry-for-delegation" class="internal xref">New Registry for Delegation Information</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-procedure" class="internal xref">Procedure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-initial-contents" class="internal xref">Initial Contents</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-temporary-assignments" class="internal xref">Temporary Assignments</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-root-zone-file" class="internal xref">Root zone file</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-exampleorg-zone-file" class="internal xref">Example.org zone file</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-examplenet-zone-file" class="internal xref">Example.net zone file</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-responses" class="internal xref">Responses</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.1">
                    <p id="section-toc.1-1.7.2.4.2.1.1"><a href="#appendix-A.4.1" class="auto internal xref">A.4.1</a>.  <a href="#name-do-bit-clear-de-bit-clear" class="internal xref">DO bit clear, DE bit clear</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.2">
                    <p id="section-toc.1-1.7.2.4.2.2.1"><a href="#appendix-A.4.2" class="auto internal xref">A.4.2</a>.  <a href="#name-do-bit-set-de-bit-clear" class="internal xref">DO bit set, DE bit clear</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.3">
                    <p id="section-toc.1-1.7.2.4.2.3.1"><a href="#appendix-A.4.3" class="auto internal xref">A.4.3</a>.  <a href="#name-do-bit-clear-de-bit-set" class="internal xref">DO bit clear, DE bit set</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.4">
                    <p id="section-toc.1-1.7.2.4.2.4.1"><a href="#appendix-A.4.4" class="auto internal xref">A.4.4</a>.  <a href="#name-do-bit-set-de-bit-set" class="internal xref">DO bit set, DE bit set</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#appendix-A.5" class="auto internal xref">A.5</a>.  <a href="#name-delegi-interpretation" class="internal xref">DELEGI Interpretation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">In the Domain Name System, responsibility for each subdomain within the domain name hierarchy can be delegated to different servers, which makes them authoritative for their portion of the namespace.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The original DNS record that does this, called an NS record, contains only the hostname of a single name server and no other parameters.
The resolver needs to resolve these names into usable addresses and infer other required parameters, such as the transport protocol and any other protocol features.
Moreover, the NS record set exists in two places--one at the delegation point, and the other, possibly different, in the child zone.
The DNS Security Extensions (DNSSEC) protect only one copy, those in the child zone.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">These properties of NS records limit resolvers to unencrypted UDP and TCP port 53, and this initial contact cannot be protected with DNSSEC.
Even if these two problems were somehow solved, the NS record does not offer extensibility for any other parameters.
This limitation is a barrier for the efficient introduction of new DNS technology.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The proposed DELEG and DELEGI resource record (RR) types remedy this problem by providing extensible parameters to indicate server capabilities and additional information, such as other transport protocols that a resolver may use.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The DELEG record creates a new delegation.
It is authoritative in the parent side of delegation and thus can be signed with DNSSEC.
This makes it possible to validate all delegation parameters, including those of future extensions.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">The DELEGI record is an auxiliary record which does not create a delegation by itself but provides an optional layer of indirection.
It can be used to share the same delegation information across any number of zones.
DELEGI is treated like regular authoritative record.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">The DELEG record can be used instead of or alongside a NS record to create a delegation.
The combination of DELEG+NS is fully compatible with old resolvers, facilitating the incremental rollout of this new method of delegation.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">Future documents can use the extensibility mechanism for more advanced features like connecting to a name server with an encrypted transport.<a href="#section-1-8" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
"OPTIONAL" in this document are to be interpreted as described in <br>
BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in
all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Terminology regarding the Domain Name System comes from <span>[<a href="#BCP219" class="cite xref">BCP219</a>]</span>, with addition terms defined here:<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.1">
            <p id="section-1.1-3.1.1">legacy delegation: A delegation that is done with an NS RRset<a href="#section-1.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.2">
            <p id="section-1.1-3.2.1">legacy response: A response that does not use the DELEG protocol described in this document<a href="#section-1.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.3">
            <p id="section-1.1-3.3.1">DELEG-aware: An authoritative server or resolver that follows the protocol defined in this document<a href="#section-1.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.4">
            <p id="section-1.1-3.4.1">DELEG-unaware: An authoritative server or resolver that does not follow the protocol defined in this document<a href="#section-1.1-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="deleg-and-delegi-resource-record-types">
<section id="section-2">
      <h2 id="name-deleg-and-delegi-resource-r">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-deleg-and-delegi-resource-r" class="section-name selfRef">DELEG and DELEGI Resource Record Types</a>
      </h2>
<p id="section-2-1">The DELEG record, RR type TBD, and the DELEGI record, RR type TBD2 (different from that of DELEG), have the same wire and presentation formats,
but their semantics are different as described in a following section.
These records are defined for the IN class.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The record format is based on the extensible key=value list that was originally defined as "SvcParams" for the SVCB record type <span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span>.
Unlike SVCB, the DELEG protocol does not have "SvcPriority" and "TargetName" fields.
The keys in the DELEG protocol are different than those used in SVCB.
To avoid confusion between the two protocols, the list of key=value parameters used by the DELEG protocol are called DelegInfos and will be tracked in their own IANA registry for Delegation Information.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The following rules are adapted from SVCB, but with changed names:<a href="#section-2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-4.1">
          <p id="section-2-4.1.1">The whole RDATA consists of a single list called "DelegInfos".<a href="#section-2-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.2">
          <p id="section-2-4.2.1">DelegInfos consists of individual DelegInfo key=value pairs.<a href="#section-2-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.3">
          <p id="section-2-4.3.1">Each DelegInfo pair has DelegInfoKey and a possibly optional DelegInfoValue.<a href="#section-2-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.4">
          <p id="section-2-4.4.1">Each DelegInfo has a specified presentation format and wire encoding.<a href="#section-2-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.5">
          <p id="section-2-4.5.1">Each DelegInfoKey has a presentation name and a registered key number.<a href="#section-2-4.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.6">
          <p id="section-2-4.6.1">Each DelegInfoValue is in a format specific to its DelegInfoKey.<a href="#section-2-4.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-5">Implementations can reuse the same code to parse SvcParams and DelegInfos and only plug in a different list of key=value pairs for SVCB/HTTPS and DELEG/DELEGI record families.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">The initial set of DelegInfoKeys and their formats are defined in <a href="#nameserver-info" class="auto internal xref">Section 3.1.5</a>.<a href="#section-2-6" class="pilcrow">¶</a></p>
<div id="presentation-format">
<section id="section-2.1">
        <h3 id="name-presentation-format">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-presentation-format" class="section-name selfRef">Presentation Format</a>
        </h3>
<p id="section-2.1-1">The RDATA presentation format of the DELEG and DELEGI resource records consists of a single list, DelegInfos.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The DelegInfos presentation format is defined exactly the same as SvcParams in Section 2.1 of <span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span>. The following rules are adapted from SVCB, but with changed names:<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-3.1">
            <p id="section-2.1-3.1.1">DelegInfos is a whitespace-separated list with each DelegInfo consisting of a DelegInfoKey=DelegInfoValue pair, or a standalone DelegInfoKey.<a href="#section-2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.2">
            <p id="section-2.1-3.2.1">Individual element definitions are the same as <span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span>:<a href="#section-2.1-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-3.2.2.1">
                <p id="section-2.1-3.2.2.1.1">The DelegInfo syntax is the same as SvcParam, but it references DelegInfo elements instead of SvcParam elements.<a href="#section-2.1-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-3.2.2.2">
                <p id="section-2.1-3.2.2.2.1">DelegInfoKey syntax is the same as SvcParamKey.<a href="#section-2.1-3.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-3.2.2.3">
                <p id="section-2.1-3.2.2.3.1">The syntax for unknown keys in Section 2.1 of <span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span> applies.<a href="#section-2.1-3.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-3.2.2.4">
                <p id="section-2.1-3.2.2.4.1">The DelegInfoValue syntax is the same as SvcParamValue.<a href="#section-2.1-3.2.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1-3.2.2.5">
                <p id="section-2.1-3.2.2.5.1">The rules from Appendix A of <span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span> apply.<a href="#section-2.1-3.2.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-2.1-3.3">
            <p id="section-2.1-3.3.1">All the requirements in Section 2.1 of <span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span> apply.<a href="#section-2.1-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-4">DelegInfos MAY be zero-length; this is similar to what is allowed in SVCB records.
A record with a zero-length DelegInfos field has no effect on the SLIST processing for resolvers.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rdata-wire-format">
<section id="section-2.2">
        <h3 id="name-rdata-wire-format">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-rdata-wire-format" class="section-name selfRef">RDATA Wire Format</a>
        </h3>
<p id="section-2.2-1">The RDATA portion of the DELEG and DELEGI resource record has variable length and entirely consists of a single "DelegInfos" element:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2-2">
<pre>
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    /                         DelegInfos                            /
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-2.2-3">The format of the DelegInfos element is identical to the format of the SvcParams element defined in <span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span> Section 2.2,
including the requirements for strictly increasing numeric order to keys and no key duplication allowed.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">All the requirements in Section 2.2 of <span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span> apply.<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<p id="section-2.2-5">The DelegInfos element is a sequence of individual DelegInfo elements.
The wire format of an individual DelegInfo element is the same as for a SvcParam element,
but it references DelegInfo elements instead of SvcParam elements.<a href="#section-2.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2-6">
<pre>
                +0 (MSB)                            +1 (LSB)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
0:  |                          DelegInfoKey                         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
2:  |                length of DelegInfoValue                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
4:  /                          DelegInfoValue ...                   /
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-2.2-6" class="pilcrow">¶</a>
</div>
<p id="section-2.2-7">The permissible lengths depend on the DelegInfoKey value.
Some future keys may have no DelegInfoValue, which would be indicated with an explicit 0 length.<a href="#section-2.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overview-of-differences-between-deleg-and-delegi-semantics">
<section id="section-2.3">
        <h3 id="name-overview-of-differences-bet">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-overview-of-differences-bet" class="section-name selfRef">Overview of Differences between DELEG and DELEGI Semantics</a>
        </h3>
<p id="section-2.3-1">The following is a brief summary of semantic differences between the DELEG and DELEGI types.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-2.1">
            <p id="section-2.3-2.1.1">DELEG creates a delegation for its owner name, similar to the NS RR type.<a href="#section-2.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-2.2">
            <p id="section-2.3-2.2.1">DELEG and NS RR types can coexist at the same owner name.<a href="#section-2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-2.3">
            <p id="section-2.3-2.3.1">DELEG is authoritative in the parent zone of the delegated zone, similar to the DS RR type, and unlike the NS RR type.<a href="#section-2.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-2.4">
            <p id="section-2.3-2.4.1">DELEG is signed by the parent zone of the delegated zone when using DNSSEC, similar to the DS RR type, and unlike the NS RR type.<a href="#section-2.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-2.5">
            <p id="section-2.3-2.5.1">DELEG cannot be present at the apex of the delegated zone, similar to the DS RR type, and unlike the NS RR type.<a href="#section-2.3-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-2.6">
            <p id="section-2.3-2.6.1">DELEG has special processing for being included in answers.<a href="#section-2.3-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.3-3">Conversely,<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-4.1">
            <p id="section-2.3-4.1.1">DELEGI is like any normal RR and doesn't require any special processing.<a href="#section-2.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-4.2">
            <p id="section-2.3-4.2.1">DELEGI does not create a delegation for its owner name.<a href="#section-2.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-4.3">
            <p id="section-2.3-4.3.1">DELEGI cannot coexist at the same owner name with DELEG or NS RR types.<a href="#section-2.3-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-4.4">
            <p id="section-2.3-4.4.1">DELEGI DNSSEC signing and record placement rules are the same as for any ordinary RR type.<a href="#section-2.3-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-4.5">
            <p id="section-2.3-4.5.1">DELEGI is used as the target of the DELEG protocol's "include" mechanism, as described in section <a href="#slist" class="auto internal xref">Section 3.1.6</a>.<a href="#section-2.3-4.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.3-5">TODO: Add some introduction comparing how resolvers see legacy delegation (set of NS and A/AAAA records) and DELEG delegation (DELEG and DELEGI records with server-ipv4 and server-ipv6 keys)<a href="#section-2.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="use-of-deleg-records">
<section id="section-3">
      <h2 id="name-use-of-deleg-records">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-use-of-deleg-records" class="section-name selfRef">Use of DELEG Records</a>
      </h2>
<p id="section-3-1">The DELEG RRset MAY contain multiple records.
A DELEG RRset MAY be present with or without NS or DS RRsets at the delegation point, though without NS records then DELEG-unaware software will not be able to resolve records in the the delegated zone.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">DELEG RRsets MUST NOT appear at a zone's apex.
The erroneous inclusion of DELEG RRset at zone's apex will cause DNSSEC validation failures.
Servers MAY refuse to load such an invalid zone, similar to the DS RR type.<a href="#section-3-2" class="pilcrow">¶</a></p>
<div id="resolvers">
<section id="section-3.1">
        <h3 id="name-resolvers">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-resolvers" class="section-name selfRef">Resolvers</a>
        </h3>
<div id="signaling-deleg-support">
<section id="section-3.1.1">
          <h4 id="name-signaling-deleg-support">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-signaling-deleg-support" class="section-name selfRef">Signaling DELEG Support</a>
          </h4>
<p id="section-3.1.1-1">There will be both DELEG and NS needed for delegation for a long time.
Both legacy delegation and the DELEG protocol enable recursive resolution.
This document defines a new EDNS flag to signal that a resolver is DELEG-aware and therefore does not need NS records or glue information in a referral response.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-2">A resolver that is DELEG-aware MUST signal in queries that it supports the DELEG protocol by setting a bit in the OPT RR TTL as described in <span>[<a href="#RFC6891" class="cite xref">RFC6891</a>]</span>.
This bit referred to as the "DELEG" (DE) bit, expected to be assigned by IANA at Bit 2 in the EDNS Header Flags registry, as follows:<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1.1-3">
<pre>
            +0 (MSB)                +1 (LSB)
     +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
  0: |   EXTENDED-RCODE      |       VERSION         |
     +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
  2: |DO|CO|DE|              Z                       |
     +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
</pre><a href="#section-3.1.1-3" class="pilcrow">¶</a>
</div>
<p id="section-3.1.1-4">Setting the DE bit to one in a query indicates the resolver understands the DELEG semantics and does not need NS records to follow a referral.
The DE bit set to 0 indicates the resolver is not DELEG-aware, and therefore can only be served referrals with NS records and other data according to pre-DELEG specifications.<a href="#section-3.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="referral">
<section id="section-3.1.2">
          <h4 id="name-referral">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-referral" class="section-name selfRef">Referral</a>
          </h4>
<p id="section-3.1.2-1">The DELEG record creates a zone cut similar to the NS record.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2-2">If one or more DELEG records exist at a given delegation point, a DELEG-aware resolver MUST treat the name servers from those DELEG records as authoritative for the child zone.
In such a case, a DELEG-aware resolver MUST NOT use NS records for the zone if they are present, even if resolution using DELEG records has failed.
Such fallback from DELEG to NS would invalidate the security guarantees of the DELEG protocol.<a href="#section-3.1.2-2" class="pilcrow">¶</a></p>
<p id="section-3.1.2-3">If no DELEG record exists at a given delegation point, DELEG-aware resolvers MUST use NS records as specified by <span>[<a href="#RFC1034" class="cite xref">RFC1034</a>]</span>.
See <a href="#dnssec-validators" class="auto internal xref">Section 3.4</a> for more information about protection from downgrade attacks.<a href="#section-3.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="parent-side-types-qtypedeleg">
<section id="section-3.1.3">
          <h4 id="name-parent-side-types-qtypedele">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-parent-side-types-qtypedele" class="section-name selfRef">Parent-side types, QTYPE=DELEG</a>
          </h4>
<p id="section-3.1.3-1">Record types defined as authoritative on the parent side of zone cut, currently the DS and DELEG types, retain the same special handling as described in Section 2.6 of <span>[<a href="#RFC4035" class="cite xref">RFC4035</a>]</span>.<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
<p id="section-3.1.3-2">DELEG-unaware resolvers can get different types of answers for QTYPE=DELEG queries based on the configuration of the server, such as whether it is DELEG-aware and whether it also is authoritative for subdomains.
For example, a DELEG-unaware authoritative name server which has loaded DELEG records via the <span>[<a href="#RFC3597" class="cite xref">RFC3597</a>]</span> unknown types mechanism would answer with them only if there were no NS records at the owner name, and answer with an NS delegation otherwise.<a href="#section-3.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="finding-best">
<section id="section-3.1.4">
          <h4 id="name-algorithm-for-finding-the-b">
<a href="#section-3.1.4" class="section-number selfRef">3.1.4. </a><a href="#name-algorithm-for-finding-the-b" class="section-name selfRef">Algorithm for "Finding the Best Servers to Ask"</a>
          </h4>
<p id="section-3.1.4-1">This document updates instructions for finding the best servers to ask.
That information currently is covered in Section 5.3.3 of <span>[<a href="#RFC1034" class="cite xref">RFC1034</a>]</span> and Section 3.4.1 of <span>[<a href="#RFC6672" class="cite xref">RFC6672</a>]</span> with the text "2. Find the best servers to ask."
Section 3.1.4.1 of <span>[<a href="#RFC4035" class="cite xref">RFC4035</a>]</span> should have explicitly updated Section 5.3.3 of <span>[<a href="#RFC1034" class="cite xref">RFC1034</a>]</span> for the DS RR type, but failed to do so.
This document simply extends this existing behavior to DELEG RR type as well, and makes this special case explicit.<a href="#section-3.1.4-1" class="pilcrow">¶</a></p>
<p id="section-3.1.4-2">When a DELEG RRset exists for a delegation in a zone, DELEG-aware resolvers ignore any NS RRset for the delegated zone, whether from the parent or from the apex of the child.<a href="#section-3.1.4-2" class="pilcrow">¶</a></p>
<p id="section-3.1.4-3">Each delegation level can have a mixture of DELEG and NS RR types, and DELEG-aware resolvers MUST be able to follow chains of delegations which combines both types in arbitrary ways.<a href="#section-3.1.4-3" class="pilcrow">¶</a></p>
<p id="section-3.1.4-4">An example of a valid delegation tree:<a href="#section-3.1.4-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1.4-5">
<pre>
; root zone with NS-only delegations
. SOA ...
test. NS ...

; test. zone with NS+DELEG delegations
test. SOA ...
sld.test. NS ...
sld.test. DELEG ...

; sld.test. zone with NS-only delegation
sld.test. SOA ...
nssub.sld.test. NS ...

; nssub.sld.test. zone with DELEG-only delegation
delegsub.sub.sld.test. DELEG ...
</pre><a href="#section-3.1.4-5" class="pilcrow">¶</a>
</div>
<p id="section-3.1.4-6">TODO: after the text below, refer back to this figure and show the order that a DELEG-aware resolver would take when there is a failure to find any good DELEG addresses at sub.sld.test, then any usable name servers at sub.sld.test, and then maybe a good DELEG record at test.<a href="#section-3.1.4-6" class="pilcrow">¶</a></p>
<p id="section-3.1.4-7">The terms SNAME and SLIST used here are defined in Section 5.3.2 of <span>[<a href="#RFC1034" class="cite xref">RFC1034</a>]</span>:<a href="#section-3.1.4-7" class="pilcrow">¶</a></p>
<p id="section-3.1.4-8">SNAME is the domain name we are searching for.<a href="#section-3.1.4-8" class="pilcrow">¶</a></p>
<p id="section-3.1.4-9">SLIST is a structure which describes the name servers and the zone which the resolver is currently trying to query.
Neither <span>[<a href="#RFC1034" class="cite xref">RFC1034</a>]</span> nor this document define how a resolver uses SLIST; they only define how to populate it.<a href="#section-3.1.4-9" class="pilcrow">¶</a></p>
<p id="section-3.1.4-10">A DELEG-aware SLIST needs to be able to hold two types of information, delegations defined by NS records and delegations defined by DELEG records.
DELEG and NS delegations can create cyclic dependencies and/or lead to duplicate entries which point to the same server.
Resolvers need to enforce suitable limits to prevent damage even if someone has incorrectly configured some of the data used to create an SLIST.<a href="#section-3.1.4-10" class="pilcrow">¶</a></p>
<p id="section-3.1.4-11">This leads to a modifications of the description from earlier documents for DELEG-aware resolvers can find the best servers to ask.
That description becomes:<a href="#section-3.1.4-11" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1.4-12">
<li id="section-3.1.4-12.1">
              <p id="section-3.1.4-12.1.1">Determine deepest possible zone cut which can potentially hold the answer for a given (query name, type, class) combination:<a href="#section-3.1.4-12.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1.4-12.1.2">
<li id="section-3.1.4-12.1.2.1">
                  <p id="section-3.1.4-12.1.2.1.1">Start with SNAME equal to QNAME.<a href="#section-3.1.4-12.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-3.1.4-12.1.2.2">
                  <p id="section-3.1.4-12.1.2.2.1">If QTYPE is a type that is authoritative at the parent side of a zone cut (currently, DS or DELEG), remove the leftmost label from SNAME.
For example, if the QNAME is "test.example." and the QTYPE is DELEG or DS, set SNAME to "example.".<a href="#section-3.1.4-12.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li id="section-3.1.4-12.2">
              <p id="section-3.1.4-12.2.1">Look for locally-available DELEG and NS RRsets, starting at current SNAME.<a href="#section-3.1.4-12.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1.4-12.2.2">
<li id="section-3.1.4-12.2.2.1">
                  <p id="section-3.1.4-12.2.2.1.1">For a given SNAME, check for the existence of a DELEG RRset.
If it exists, the resolver MUST use its content to populate SLIST.
However, if the DELEG RRset is known to exist but is unusable (for example, if it is found in DNSSEC BAD cache), the resolver MUST NOT instead use an NS RRset; instead, the resolver MUST treat this case as if no servers were available.<a href="#section-3.1.4-12.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-3.1.4-12.2.2.2">
                  <p id="section-3.1.4-12.2.2.2.1">If a given SNAME is proven to not have a DELEG RRset but does have an NS RRset, the resolver MUST copy the NS RRset into SLIST.<a href="#section-3.1.4-12.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-3.1.4-12.2.2.3">
                  <p id="section-3.1.4-12.2.2.3.1">If SLIST is now populated, stop walking up the DNS tree.
However, if SLIST is not populated, remove the leftmost label from SNAME and go back to the first step, using the newly shortened SNAME.
Do not go back to the first step if doing so would exceed the amount of work that the resolver is configured to do when processing names; see <a href="#too-much-work" class="auto internal xref">Section 4.1</a>.<a href="#section-3.1.4-12.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
          </ol>
<p id="section-3.1.4-13">The rest of Step 2's description is not affected by this document.<a href="#section-3.1.4-13" class="pilcrow">¶</a></p>
<p id="section-3.1.4-14">Resolvers MAY respond to "QNAME=. / QTYPE=DELEG" queries in the same fashion as they respond to "QNAME=. / QTYPE=DS" queries.<a href="#section-3.1.4-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="nameserver-info">
<section id="section-3.1.5">
          <h4 id="name-name-server-information-for">
<a href="#section-3.1.5" class="section-number selfRef">3.1.5. </a><a href="#name-name-server-information-for" class="section-name selfRef">Name Server Information for Delegation</a>
          </h4>
<p id="section-3.1.5-1">The DELEG and DELEGI records have four keys that describe information about name servers.
The purpose of this information is to populate the SLIST with IP addresses of the name servers for a zone.
The types of information defined in this document are:<a href="#section-3.1.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.5-2.1">
              <p id="section-3.1.5-2.1.1">server-ipv4: an unordered collection of IPv4 addresses for name servers<a href="#section-3.1.5-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.5-2.2">
              <p id="section-3.1.5-2.2.1">server-ipv6: an unordered collection of IPv6 addresses for name servers<a href="#section-3.1.5-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.5-2.3">
              <p id="section-3.1.5-2.3.1">server-name: an unordered collection of hostnames of name servers; the addresses must be fetched<a href="#section-3.1.5-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.5-2.4">
              <p id="section-3.1.5-2.4.1">include-delegi: an unordered collection of domain names that point to a DELEGI RRsets, which in turn have more information about the delegation<a href="#section-3.1.5-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.1.5-3">These keys MUST have a non-empty DelegInfoValue.<a href="#section-3.1.5-3" class="pilcrow">¶</a></p>
<p id="section-3.1.5-4">The presentation values for server-ipv4 and server-ipv6 are comma-separated list of one or more IP addresses of the appropriate family in standard textual format <span>[<a href="#RFC5952" class="cite xref">RFC5952</a>]</span> <span>[<a href="#RFC4001" class="cite xref">RFC4001</a>]</span>.
The wire formats for server-ipv4 and server-ipv6 are a sequence of IP addresses, in network byte order, for the respective address family.<a href="#section-3.1.5-4" class="pilcrow">¶</a></p>
<p id="section-3.1.5-5">The presentation values for server-name and include-delegi are an unordered collection of fully-qualified domain names and relative domain names, separated by commas.
The wire format for server-name and include-delegi are each a concatenated set of a wire-format domain names, where the root label provides the separation between names.
The names in the wire format MUST NOT be compressed.<a href="#section-3.1.5-5" class="pilcrow">¶</a></p>
<p id="section-3.1.5-6">TODO: Describe how escaping works for server-name and include-delegi.
This will be the same as the escaping mechanism defined in SVCB.<a href="#section-3.1.5-6" class="pilcrow">¶</a></p>
<p id="section-3.1.5-7">A DELEG or DELEGI record that has a non-empty DelegInfos MUST have one, and only one, set of server information, chosen from the following:<a href="#section-3.1.5-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.5-8.1">
              <p id="section-3.1.5-8.1.1">one server-ipv4 key<a href="#section-3.1.5-8.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.5-8.2">
              <p id="section-3.1.5-8.2.1">one server-ipv6 key<a href="#section-3.1.5-8.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.5-8.3">
              <p id="section-3.1.5-8.3.1">a pair consisting of one server-ipv4 key and one server-ipv6 key<a href="#section-3.1.5-8.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.5-8.4">
              <p id="section-3.1.5-8.4.1">one server-name key<a href="#section-3.1.5-8.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.5-8.5">
              <p id="section-3.1.5-8.5.1">one include-delegi key<a href="#section-3.1.5-8.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.1.5-9">This restriction only applies to a single DELEG or DELEGI record; a DELEG or DELEGI RRset can have records with different server information keys.<a href="#section-3.1.5-9" class="pilcrow">¶</a></p>
<p id="section-3.1.5-10">When using server-name, the addresses for all the names in the set must be fetched using normal DNS resolution.
This means the names in the value of the server-name key or the include-delegi key MUST NOT be inside the delegated domain.<a href="#section-3.1.5-10" class="pilcrow">¶</a></p>
<p id="section-3.1.5-11">With this initial DELEG specification, servers are still expected to be reached on the standard DNS port for both UDP and TCP, 53.  While a future specification is expected to address other transports using other ports, its eventual semantics are not covered here.<a href="#section-3.1.5-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="slist">
<section id="section-3.1.6">
          <h4 id="name-populating-the-slist-from-d">
<a href="#section-3.1.6" class="section-number selfRef">3.1.6. </a><a href="#name-populating-the-slist-from-d" class="section-name selfRef">Populating the SLIST from DELEG and DELEGI Records</a>
          </h4>
<p id="section-3.1.6-1">Each individual DELEG record inside a DELEG RRset, or each individual DELEGI record in a DELEGI RRset, can cause the addition of zero or more entries to SLIST.<a href="#section-3.1.6-1" class="pilcrow">¶</a></p>
<p id="section-3.1.6-2">A resolver processes each individual DELEG record within a DELEG RRset, or each individual DELEGI record in a DELEGI RRset, using the following steps:<a href="#section-3.1.6-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1.6-3">
<li id="section-3.1.6-3.1">
              <p id="section-3.1.6-3.1.1">If a record has more than one type of server information key (excluding the IPv4/IPV6 case), or has multiple server information keys of the same type, that record is malformed.
Stop processing this record.<a href="#section-3.1.6-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.6-3.2">
              <p id="section-3.1.6-3.2.1">If server-ipv4 and/or server-ipv6 keys are present inside the record, copy all of the address values into SLIST.
Stop processing this record.<a href="#section-3.1.6-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.6-3.3">
              <p id="section-3.1.6-3.3.1">If a server-name key is present in the record, resolve each name in the value into IPv4 and/or IPv6 addresses.
Copy these addresses into SLIST.
Stop processing this record.<a href="#section-3.1.6-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.6-3.4">
              <p id="section-3.1.6-3.4.1">If an include-delegi key is present in the record, resolve each name in the value using the DELEGI RR type.
Recursively apply the algorithm described in this section, after checking that the maximum loop count described in <a href="#too-much-work" class="auto internal xref">Section 4.1</a> has not been reached.<a href="#section-3.1.6-3.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.6-3.5">
              <p id="section-3.1.6-3.5.1">If none of the above applies, SLIST is not modified by this particular record.<a href="#section-3.1.6-3.5.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-3.1.6-4">A DELEG-aware resolver MAY implement lazy filling of SLIST, such as by deferring processing remaining records if SLIST already has what the resolver considers a sufficiently large pool of addresses to contact.<a href="#section-3.1.6-4" class="pilcrow">¶</a></p>
<p id="section-3.1.6-5">The order in which to try the servers in the final SLIST is outside the scope of this document.<a href="#section-3.1.6-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="authoritative-servers">
<section id="section-3.2">
        <h3 id="name-authoritative-servers">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-authoritative-servers" class="section-name selfRef">Authoritative Servers</a>
        </h3>
<p id="section-3.2-1">The DELEG RR type defines a zone cut in similar way as the NS RR type.
Behavior defined for zone cuts in existing pre-DELEG specifications apply to zone cuts created by the DELEG record.
A notable example of this is that the occlusion (usually accidentally) created by NS records in a parent zone would also be created by DELEG records in a parent zone.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">DELEG-aware authoritative servers act differently when handling queries from DELEG-unaware clients (those with DE=0) than from DELEG-aware clients (those with DE=1).<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">The server MUST copy the value of the DE bit from the query into the response, to signal that it is a DELEG-aware server.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<div id="deleg-aware-clients">
<section id="section-3.2.1">
          <h4 id="name-deleg-aware-clients">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-deleg-aware-clients" class="section-name selfRef">DELEG-aware Clients</a>
          </h4>
<p id="section-3.2.1-1">When the client indicates that it is DELEG-aware by setting DE=1 in the query, DELEG-aware authoritative servers treat DELEG records as zone cuts, and the servers are authoritative on the parent side of the zone cut.
This new zone cut has priority over a legacy delegation.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<div id="deleg-aware-clients-requesting-qtypedeleg">
<section id="section-3.2.1.1">
            <h5 id="name-deleg-aware-clients-request">
<a href="#section-3.2.1.1" class="section-number selfRef">3.2.1.1. </a><a href="#name-deleg-aware-clients-request" class="section-name selfRef">DELEG-aware Clients Requesting QTYPE=DELEG</a>
            </h5>
<p id="section-3.2.1.1-1">An explicit query for the DELEG RR type at a delegation point behaves much like query for the DS RR type: the server answers authoritatively from the parent zone.
All pre-DELEG specifications for special handling queries with QTYPE=DS apply equally to QTYPE=DELEG.
In summary, the server either provides an authoritative DELEG RRset or declares its non-existence, with relevant DNSSEC proofs when requested and available.<a href="#section-3.2.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="delegation-with-deleg">
<section id="section-3.2.1.2">
            <h5 id="name-delegation-with-deleg">
<a href="#section-3.2.1.2" class="section-number selfRef">3.2.1.2. </a><a href="#name-delegation-with-deleg" class="section-name selfRef">Delegation with DELEG</a>
            </h5>
<p id="section-3.2.1.2-1">If the delegation has a DELEG RRset, the authoritative server MUST put the DELEG RRset into the Authority section of the referral.
In this case, the server MUST NOT include the NS RRset in the Authority section.
Include the covering RRSIG following the normal DNSSEC procedure for answers with authoritative zone data.<a href="#section-3.2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1.2-2">Similarly, rules for DS RRset inclusion in referrals apply as specified by the DNSSEC protocol.<a href="#section-3.2.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="deleg-aware-clients-with-ns-rrs-present-but-no-deleg-rrs">
<section id="section-3.2.1.3">
            <h5 id="name-deleg-aware-clients-with-ns">
<a href="#section-3.2.1.3" class="section-number selfRef">3.2.1.3. </a><a href="#name-deleg-aware-clients-with-ns" class="section-name selfRef">DELEG-aware Clients with NS RRs Present but No DELEG RRs</a>
            </h5>
<p id="section-3.2.1.3-1">If the delegation does not have a DELEG RRset, the authoritative server MUST put the NS RRset into the authority section of the referral.
The absence of the DELEG RRset MUST be proven as specified by the DNSSEC protocol for authoritative data.<a href="#section-3.2.1.3-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1.3-2">Similarly, rules for DS RRset inclusion into referrals apply as specified by the DNSSEC protocol.
Please note, in practice the same process and records are used to prove the non-existence of both DELEG and DS RRsets.<a href="#section-3.2.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="deleg-unaware-clients">
<section id="section-3.2.2">
          <h4 id="name-deleg-unaware-clients">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-deleg-unaware-clients" class="section-name selfRef">DELEG-unaware Clients</a>
          </h4>
<p id="section-3.2.2-1">A general principle for DELEG-aware authoritative servers is that they respond to a DELEG-unaware client by following pre-DELEG specifications.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">DELEG-unaware clients do not recognize DELEG records as a zone cut and are not aware of the special handling rules for DELEG records.
They understand a DELEG RRset as an ordinary unknown RR type.<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2.2-3">In summary, DELEG records are not returned in referral responses to DELEG-unaware clients,
and DELEG-unaware clients do not consider DELEG records authoritative on the parent side of a zone cut.<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2.2-4">An authoritative server responding to DELEG-unaware clients has to handle three distinct situations:<a href="#section-3.2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2-5.1">
              <p id="section-3.2.2-5.1.1">No DELEG RRset is present. In this case, the authoritative server follows the pre-DELEG specifications.<a href="#section-3.2.2-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.2-5.2">
              <p id="section-3.2.2-5.2.1">An NS RRset and a DELEG RRset are both present. In this case, the authoritative server uses the NS RRset when constructing referral responses, following the pre-DELEG specifications. See also <a href="#signers" class="auto internal xref">Section 3.3</a> and <a href="#examples" class="auto internal xref">Appendix A</a>.<a href="#section-3.2.2-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.2-5.3">
              <p id="section-3.2.2-5.3.1">A DELEG RRset is present, but an NS RRset is not. See <a href="#no-ns" class="auto internal xref">Section 3.2.2.1</a>.<a href="#section-3.2.2-5.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div id="no-ns">
<section id="section-3.2.2.1">
            <h5 id="name-deleg-unaware-clients-with-">
<a href="#section-3.2.2.1" class="section-number selfRef">3.2.2.1. </a><a href="#name-deleg-unaware-clients-with-" class="section-name selfRef">DELEG-unaware Clients with DELEG RRs Present but No NS RRs</a>
            </h5>
<p id="section-3.2.2.1-1">Authoritative servers may receive requests from DELEG-unaware clients for which the child zone is authoritative and is delegated with DELEG RRs only (that is, without any NS RRs).
Such a zone is by definition not resolvable for DELEG-unaware clients.
From the perspective of a DELEG-unaware client, the zone cut created by the DELEG RRs is invisible.
In such a situation, the authoritative server should respnd in a way to limit confusion and/or colateral damage for the DELEG-unaware client.<a href="#section-3.2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2.1-2">The authoritative server is RECOMMENDED to supplement its responses to DELEG-unaware resolvers with an <span>[<a href="#RFC8914" class="cite xref">RFC8914</a>]</span> Extended DNS Error using the (IANA-TBD) value "New Delegation Only" from the Extended DNS Error Codes registry.<a href="#section-3.2.2.1-2" class="pilcrow">¶</a></p>
<p id="section-3.2.2.1-3">A DELEG-aware authoritative server implementation has two options:<a href="#section-3.2.2.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2.2.1-4">
<li id="section-3.2.2.1-4.1">
                <p id="section-3.2.2.1-4.1.1">When faced with a client that sent a query with DE=0 that would lead to a delegation, but the zone has no NS records, an authoritative server MAY reply with an RCODE of SERVFAIL and nothing in the Answer and Authority sections.<a href="#section-3.2.2.1-4.1.1" class="pilcrow">¶</a></p>
<p id="section-3.2.2.1-4.1.2">
This response has negative side effects, namely that most resolvers will then query the remaining authoritative servers to see if any of them would give a different answer.
The advantage of this approach is simplicity of implementation and it is easy to understand.<a href="#section-3.2.2.1-4.1.2" class="pilcrow">¶</a></p>
</li>
              <li id="section-3.2.2.1-4.2">
                <p id="section-3.2.2.1-4.2.1">Because of the negative side effects of the previous option, an authoritative server SHOULD instead send an answer that accurately describes the situation to a DELEG-unaware resolver.<a href="#section-3.2.2.1-4.2.1" class="pilcrow">¶</a></p>
<p id="section-3.2.2.1-4.2.2">
The NSEC chain and the type bitmap generated according to <a href="#signers" class="auto internal xref">Section 3.3</a> leads to exactly one possible answer which is valid according to pre-DELEG specifications.
See <a href="#examples" class="auto internal xref">Appendix A</a> for several examples of such answers.<a href="#section-3.2.2.1-4.2.2" class="pilcrow">¶</a></p>
<p id="section-3.2.2.1-4.2.3">
Please note different interpretation of DELEG RR type and zone cut definitions between DELEG-aware authoritative server and DELEG-unaware client. It is confusing.<a href="#section-3.2.2.1-4.2.3" class="pilcrow">¶</a></p>
</li>
            </ol>
<p id="section-3.2.2.1-5">TODO: List as many of the possible situations that need to be considered for variant 2, and the proposed the single appropriate response for each situation. This list will probably change for the next few iterations of this draft.<a href="#section-3.2.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="deleg-unaware-clients-requesting-qtypedeleg">
<section id="section-3.2.2.2">
            <h5 id="name-deleg-unaware-clients-reque">
<a href="#section-3.2.2.2" class="section-number selfRef">3.2.2.2. </a><a href="#name-deleg-unaware-clients-reque" class="section-name selfRef">DELEG-unaware Clients Requesting QTYPE=DELEG</a>
            </h5>
<p id="section-3.2.2.2-1">From the perspective of DELEG-unaware clients, the DELEG RR type does not have special semantics and should behave like an old ordinary RR type such as TXT.
Thus, queries with DE=0 and QTYPE=DELEG MUST result in a legacy response which can be validated by DELEG-unaware client.<a href="#section-3.2.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2.2-2.1">
                <p id="section-3.2.2.2-2.1.1">If there is an NS RRset, this will be a legacy referral to the child zone. From the perspective of a DELEG-unaware client, the DELEG RR is effectively occluded by NS RRset.
The DELEG-unaware resolver can then obtain a final answer which can be validated from the child zone in similar fashion as described in <span>[<a href="#RFC4035" class="cite xref">RFC4035</a>]</span> section 3.1.4.1.<a href="#section-3.2.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.2.2-2.2">
                <p id="section-3.2.2.2-2.2.1">If there is no NS RRset but there is a DELEG RRset, this will be a normal authoritative response with the DELEG RRset, following pre-DELEG specifications.<a href="#section-3.2.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.2.2-2.3">
                <p id="section-3.2.2.2-2.3.1">If there is no NS RRset and no DELEG RRset, this will be a standard negative response following pre-DELEG specifications.<a href="#section-3.2.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.2.2-3">TODO: Should we have an example with auth having parent+child zone at the same time, and DE=0 QTYPE=DELEG query?<a href="#section-3.2.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="signers">
<section id="section-3.3">
        <h3 id="name-dnssec-signers">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-dnssec-signers" class="section-name selfRef">DNSSEC Signers</a>
        </h3>
<p id="section-3.3-1">The DELEG record is authoritative on the parent side of a zone cut and needs to be signed as such.
Existing rules from the DNSSEC specifications apply.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">In summary: for DNSSEC signing, treat the DELEG RR type the same way as the DS RR type.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">DELEG RR type defines a zone cut in similar way as NS RR type. This has several consequences which stem from existing pre-DELEG specifications:<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-4.1">
            <p id="section-3.3-4.1.1">All owner names below zone cut are occluded and thus not present in NSEC chains.<a href="#section-3.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-4.2">
            <p id="section-3.3-4.2.1">All RRsets which are not permissible at the parent side of zone cut are occluded too and not represented in NSEC chain type bitmap.<a href="#section-3.3-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-5">See examples in <a href="#example-root" class="auto internal xref">Appendix A.1</a> and <a href="#example-occluded" class="auto internal xref">Appendix A.4.2.3</a>.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6">In order to protect validators from downgrade attacks this draft introduces a new DNSKEY flag ADT (Authoritative Delegation Types).
In zones which contain a DELEG RRset, this flag MUST be set to 1 in at least one of the DNSKEY records published in the zone.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dnssec-validators">
<section id="section-3.4">
        <h3 id="name-dnssec-validators">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-dnssec-validators" class="section-name selfRef">DNSSEC Validators</a>
        </h3>
<p id="section-3.4-1">DELEG awareness introduces additional requirements on validators.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<div id="clarifications-on-nonexistence-proofs">
<section id="section-3.4.1">
          <h4 id="name-clarifications-on-nonexiste">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-clarifications-on-nonexiste" class="section-name selfRef">Clarifications on Nonexistence Proofs</a>
          </h4>
<p id="section-3.4.1-1">This document updates Section 4.1 of <span>[<a href="#RFC6840" class="cite xref">RFC6840</a>]</span> to include "NS or DELEG" types in the type bitmap as indication of a delegation point, and generalizes applicability of ancestor delegation proof to all RR types that are authoritative at the parent (that is, both DS and DELEG).
The text in that section is updated as follows:<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<p id="section-3.4.1-2">An "ancestor delegation" NSEC RR (or NSEC3 RR) is one with:<a href="#section-3.4.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.1-3.1">
              <p id="section-3.4.1-3.1.1">the NS and/or DELEG bit set,<a href="#section-3.4.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.4.1-3.2">
              <p id="section-3.4.1-3.2.1">the Start of Authority (SOA) bit clear, and<a href="#section-3.4.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.4.1-3.3">
              <p id="section-3.4.1-3.3.1">a signer field that is shorter than the owner name of the NSEC RR,
or the original owner name for the NSEC3 RR.<a href="#section-3.4.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.4.1-4">Ancestor delegation NSEC or NSEC3 RRs MUST NOT be used to assume
nonexistence of any RRs below that zone cut, which include all RRs at
that (original) owner name, other than types authoritative at the parent-side of a
zone cut (DS and DELEG), and all RRs below that owner name regardless of
type.<a href="#section-3.4.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="insecure-delegation-proofs">
<section id="section-3.4.2">
          <h4 id="name-insecure-delegation-proofs">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-insecure-delegation-proofs" class="section-name selfRef">Insecure Delegation Proofs</a>
          </h4>
<p id="section-3.4.2-1">This document updates Section 4.4 of <span>[<a href="#RFC6840" class="cite xref">RFC6840</a>]</span> to include securing DELEG records, and explicitly states that Opt-Out is not applicable to the DELEG protocol.
The first paragraph of that section is updated to read:<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<p id="section-3.4.2-2">Section 5.2 of <span>[<a href="#RFC4035" class="cite xref">RFC4035</a>]</span> specifies that a validator, when proving a
delegation is not secure, needs to check for the absence of the DS
and SOA bits in the NSEC (or NSEC3) type bitmap; this was clarified in Section 4.1 of <span>[<a href="#RFC6840" class="cite xref">RFC6840</a>]</span>.
This document updates <span>[<a href="#RFC4035" class="cite xref">RFC4035</a>]</span> and <span>[<a href="#RFC6840" class="cite xref">RFC6840</a>]</span> to specify that the validator MUST also check for the presence of the NS or the DELEG bit in the matching NSEC (or NSEC3) RR (proving that there is, indeed, a delegation).
Alternately, the validator must make sure that the delegation with an NS record is covered by an NSEC3
RR with the Opt-Out flag set.
Opt-Out is not applicable to DELEG RR type
because DELEG records are authoritative at the parent side of a zone cut in the same
way that DS RR types are.<a href="#section-3.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="referral-downgrade-protection">
<section id="section-3.4.3">
          <h4 id="name-referral-downgrade-protecti">
<a href="#section-3.4.3" class="section-number selfRef">3.4.3. </a><a href="#name-referral-downgrade-protecti" class="section-name selfRef">Referral downgrade protection</a>
          </h4>
<p id="section-3.4.3-1">If the zone is DNSSEC-secure, and if any DNSKEY of the zone has the ADT flag set to 1, a DELEG-aware validator MUST prove the absence of a DELEG RRset in referral responses from this particular zone.<a href="#section-3.4.3-1" class="pilcrow">¶</a></p>
<p id="section-3.4.3-2">Without this check, an attacker could strip the DELEG RRset from a referral response and replace it with an unsigned (and potentially malicious) NS RRset.
A referral response with an unsigned NS and signed DS RRsets does not require additional proofs of nonexistence according to pre-DELEG DNSSEC specification, and it would have been accepted as a delegation without the DELEG RRset.<a href="#section-3.4.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="chaining">
<section id="section-3.4.4">
          <h4 id="name-chaining">
<a href="#section-3.4.4" class="section-number selfRef">3.4.4. </a><a href="#name-chaining" class="section-name selfRef">Chaining</a>
          </h4>
<p id="section-3.4.4-1">A Validating Stub Resolver that is DELEG-aware has to use a Security-Aware Resolver that is DELEG-aware and, if it is behind a forwarder, that forwarder has to be security-aware and DELEG-aware as well.<a href="#section-3.4.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4.4-2"><span>[<a href="#RFC9606" class="cite xref">RFC9606</a>]</span> specifies a DNS resource record type RESINFO to allow resolvers to publish information about their capabilities and policies. This can be used to inform DNS clients that DELEG is supported by the DNS resolver.<a href="#section-3.4.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4.4-3">A resolver which supports <span>[<a href="#RFC9606" class="cite xref">RFC9606</a>]</span> SHOULD add the "deleg" key if it supports DELEG protocol.<a href="#section-3.4.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4.4-4">Note that, per the rules for the keys defined in Section 6.4 of <span>[<a href="#RFC6763" class="cite xref">RFC6763</a>]</span>, if there is no '=' in a key, then it is a boolean attribute, simply identified as being present, with no value.<a href="#section-3.4.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-4-1">TODO: Add more here<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="too-much-work">
<section id="section-4.1">
        <h3 id="name-preventing-over-work-attack">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-preventing-over-work-attack" class="section-name selfRef">Preventing Over-work Attacks</a>
        </h3>
<p id="section-4.1-1">Resolvers MUST prevent situations where accidental misconfiguration of zones or malicious attacks cause them to perform too much work when resolving.
This document describes two sets of actions that, if not controlled, could lead to over-work attacks.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">Long chains of include-delegi information (<a href="#nameserver-info" class="auto internal xref">Section 3.1.5</a>), and those with circular chains of include-delegi information, can be burdensome.
To prevent this, the resolver SHOULD NOT follow more than 3 include-delegi chains in an RRset when populating SLIST.
Note that include-delegi chains can have CNAME steps in them; in such a case, a CNAME step is counted the same as a DELEGI step when determining when to stop following a chain.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="preventing-downgrade-attacks">
<section id="section-4.2">
        <h3 id="name-preventing-downgrade-attack">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-preventing-downgrade-attack" class="section-name selfRef">Preventing Downgrade Attacks</a>
        </h3>
<p id="section-4.2-1">TODO: this section is a bit redundant with "Referral Downgrade Protection" above; harmonize them.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">During the rollout of the DELEG protocol, the operator of an authoritative server can upgrade the server software to be DELEG-aware before changing any DNS zones.
Such deployment should work and provide DELEG-aware clients with correct DELEG-aware answers.
However, the deployment will not be protected from downgrade attacks against the DELEG protocol.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">To protect DNSSEC-secure DNS zones that use DELEG delegations, the delegating zone needs to have at least one DNSKEY with the ADT flag set to 1.
Failure to set this flag in a DNSKEY record in the zone allows an attacker to remove the DELEG RRset from referrals which contain the DS RRset, and replace the original signed DELEG RRset with an arbitrary unsigned NS set.
Doing so would be a downgrade from the strong protection offered by DNSSEC for DELEG.
That is, the DELEG protocol when used with upgraded DNSKEY records gives the same protection to DELEG that the zone's DS RR set has.
Without DELEG, there are no security guarantees for the NS RR set on the parent side of the zone cut.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">Please note that a full DNSKEY rollover is not necessary to achieve the downgrade protection for DELEG.
Any single DNSKEY with the ADT flag set to 1 is sufficient; the zone can introduce an otherwise unused record into the DNSKEY RRset.
This DNSKEY RR can even use an unknown signing algorithm and zero-length key material to minimize size increase of the DNSKEY RRset.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="changes-to-existing-registries">
<section id="section-5.1">
        <h3 id="name-changes-to-existing-registr">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-changes-to-existing-registr" class="section-name selfRef">Changes to Existing Registries</a>
        </h3>
<p id="section-5.1-1">IANA is requested to allocate the DELEG RR and the DELEGI RR in the Resource Record (RR) TYPEs registry, with the meaning "enhanced delegation information" and referencing this document.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">IANA is requested to assign a new bit in the DNSKEY RR Flags registry (<span>[<a href="#RFC4034" class="cite xref">RFC4034</a>]</span>) for the ADT bit (N), with the description "Authoritative Delegation Types" and referencing this document.
For compatibility reasons, we request the bit 14 to be used.
This value has been proven to work whereas bit 0 was proven to break in practical deployments (because of bugs).<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">IANA is requested to assign a bit from the EDNS Header Flags registry (<span>[<a href="#RFC6891" class="cite xref">RFC6891</a>]</span>), with the abbreviation DE, the description "DELEG enabled", and referencing this document.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">IANA is requested to assign a value from the Extended DNS Error Codes (<span>[<a href="#RFC8914" class="cite xref">RFC8914</a>]</span>), with the Purpose "New Delegation Only" and referencing this document.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">IANA is requested to add the name "deleg" to DNS Resolver Information Keys registry (<span class="contact-name">RFC9606</span>),
with the description of "The presence of the key indicates that DELEG protocol is supported."
and referencing this document.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="new-registry-for-delegation-information">
<section id="section-5.2">
        <h3 id="name-new-registry-for-delegation">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-new-registry-for-delegation" class="section-name selfRef">New Registry for Delegation Information</a>
        </h3>
<p id="section-5.2-1">IANA is requested to create the "DELEG Delegation Information" registry.
This registry defines the namespace for delegation information keys, including string representations and numeric key values.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="procedure">
<section id="section-5.2.1">
          <h4 id="name-procedure">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-procedure" class="section-name selfRef">Procedure</a>
          </h4>
<p id="section-5.2.1-1">A registration MUST include the following fields:<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">Number:  Wire-format numeric identifier (range 0-65535)
Name:  Unique presentation name
Meaning:  A short description
Reference:  Location of specification or registration source
Change Controller:  Person or entity, with contact information if appropriate<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1-3">To enable code reuse from SVCB parsers, the requirements for registered Name exactly copy requirements set by <span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span> section 14.3.1:
The characters in the registered Name field entry MUST be lowercase alphanumeric or "-".
The name MUST NOT start with "key" or "invalid".<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1-4">The registration policy for new entries is Expert Review (<span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>).
The designated expert MUST ensure that the reference is stable and publicly available and that it specifies how to convert the delegation information's presentation format to wire format.
The reference MAY be any individual's Internet-Draft or a document from any other source with similar assurances of stability and availability.
An entry MAY specify a reference of the form "Same as (other key name)" if it uses the same presentation and wire formats as an existing key.<a href="#section-5.2.1-4" class="pilcrow">¶</a></p>
<p id="section-5.2.1-5">This arrangement supports the development of new parameters while ensuring that zone files can be made interoperable.<a href="#section-5.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="initial-contents">
<section id="section-5.2.2">
          <h4 id="name-initial-contents">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-initial-contents" class="section-name selfRef">Initial Contents</a>
          </h4>
<p id="section-5.2.2-1">The "DELEG Delegation Information" registry should be populated with the following initial registrations:<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.2-2">
<pre>
Number:  1
Name:  server-ipv4
Meaning:  An unordered collection of IPv4 addresses of name servers
Reference:  {{nameserver-info}} of this document
Change Controller:  IETF

Number:  2
Name:  server-ipv6
Meaning:  An unordered collection of IPv6 addresses of name servers
Reference:  {{nameserver-info}} of this document
Change Controller:  IETF

Number:  3
Name:  server-name
Meaning:  An unordered collection of hostnames of name servers
Reference:  {{nameserver-info}} of this document
Change Controller:  IETF

Number:  4
Name:  include-delegi
Meaning:  An unordered collection of domain names of DELEGI records
Reference:  {{nameserver-info}} of this document
Change Controller:  IETF

The registration for numbers 65280-65534 is reserved for private use.
The registration for number 65535 is reserved.
</pre><a href="#section-5.2.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="temporary-assignments">
<section id="section-5.3">
        <h3 id="name-temporary-assignments">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-temporary-assignments" class="section-name selfRef">Temporary Assignments</a>
        </h3>
<p id="section-5.3-1">This section gives the values that can be used for interoperability testing before IANA makes permanent assignments.
The section will be removed when IANA makes permanent assignments.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-2.1">
            <p id="section-5.3-2.1.1">DELEG RR type code is 61440<a href="#section-5.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-2.2">
            <p id="section-5.3-2.2.1">DELEGI RR type code is 65433<a href="#section-5.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-2.3">
            <p id="section-5.3-2.3.1">DELEG EDNS DE flag bit is 2<a href="#section-5.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-2.4">
            <p id="section-5.3-2.4.1">DNSKEY ADT (Authoritative Delegation Types) flag bit is 14<a href="#section-5.3-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-6">
      <h2 id="name-references">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-6.1">
        <h3 id="name-normative-references">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC1034">[RFC1034]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - concepts and facilities"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1034</span>, <span class="seriesInfo">DOI 10.17487/RFC1034</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1034">https://www.rfc-editor.org/rfc/rfc1034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4034">[RFC4034]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Austein, R.</span>, <span class="refAuthor">Larson, M.</span>, <span class="refAuthor">Massey, D.</span>, and <span class="refAuthor">S. Rose</span>, <span class="refTitle">"Resource Records for the DNS Security Extensions"</span>, <span class="seriesInfo">RFC 4034</span>, <span class="seriesInfo">DOI 10.17487/RFC4034</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4034">https://www.rfc-editor.org/rfc/rfc4034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4035">[RFC4035]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Austein, R.</span>, <span class="refAuthor">Larson, M.</span>, <span class="refAuthor">Massey, D.</span>, and <span class="refAuthor">S. Rose</span>, <span class="refTitle">"Protocol Modifications for the DNS Security Extensions"</span>, <span class="seriesInfo">RFC 4035</span>, <span class="seriesInfo">DOI 10.17487/RFC4035</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4035">https://www.rfc-editor.org/rfc/rfc4035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6672">[RFC6672]</dt>
        <dd>
<span class="refAuthor">Rose, S.</span> and <span class="refAuthor">W. Wijngaards</span>, <span class="refTitle">"DNAME Redirection in the DNS"</span>, <span class="seriesInfo">RFC 6672</span>, <span class="seriesInfo">DOI 10.17487/RFC6672</span>, <time datetime="2012-06" class="refDate">June 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6672">https://www.rfc-editor.org/rfc/rfc6672</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6763">[RFC6763]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"DNS-Based Service Discovery"</span>, <span class="seriesInfo">RFC 6763</span>, <span class="seriesInfo">DOI 10.17487/RFC6763</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6763">https://www.rfc-editor.org/rfc/rfc6763</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6840">[RFC6840]</dt>
        <dd>
<span class="refAuthor">Weiler, S., Ed.</span> and <span class="refAuthor">D. Blacka, Ed.</span>, <span class="refTitle">"Clarifications and Implementation Notes for DNS Security (DNSSEC)"</span>, <span class="seriesInfo">RFC 6840</span>, <span class="seriesInfo">DOI 10.17487/RFC6840</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6840">https://www.rfc-editor.org/rfc/rfc6840</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6891">[RFC6891]</dt>
        <dd>
<span class="refAuthor">Damas, J.</span>, <span class="refAuthor">Graff, M.</span>, and <span class="refAuthor">P. Vixie</span>, <span class="refTitle">"Extension Mechanisms for DNS (EDNS(0))"</span>, <span class="seriesInfo">STD 75</span>, <span class="seriesInfo">RFC 6891</span>, <span class="seriesInfo">DOI 10.17487/RFC6891</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6891">https://www.rfc-editor.org/rfc/rfc6891</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8914">[RFC8914]</dt>
        <dd>
<span class="refAuthor">Kumari, W.</span>, <span class="refAuthor">Hunt, E.</span>, <span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Hardaker, W.</span>, and <span class="refAuthor">D. Lawrence</span>, <span class="refTitle">"Extended DNS Errors"</span>, <span class="seriesInfo">RFC 8914</span>, <span class="seriesInfo">DOI 10.17487/RFC8914</span>, <time datetime="2020-10" class="refDate">October 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8914">https://www.rfc-editor.org/rfc/rfc8914</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9460">[RFC9460]</dt>
        <dd>
<span class="refAuthor">Schwartz, B.</span>, <span class="refAuthor">Bishop, M.</span>, and <span class="refAuthor">E. Nygren</span>, <span class="refTitle">"Service Binding and Parameter Specification via the DNS (SVCB and HTTPS Resource Records)"</span>, <span class="seriesInfo">RFC 9460</span>, <span class="seriesInfo">DOI 10.17487/RFC9460</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9460">https://www.rfc-editor.org/rfc/rfc9460</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9606">[RFC9606]</dt>
      <dd>
<span class="refAuthor">Reddy.K, T.</span> and <span class="refAuthor">M. Boucadair</span>, <span class="refTitle">"DNS Resolver Information"</span>, <span class="seriesInfo">RFC 9606</span>, <span class="seriesInfo">DOI 10.17487/RFC9606</span>, <time datetime="2024-06" class="refDate">June 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9606">https://www.rfc-editor.org/rfc/rfc9606</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-6.2">
        <h3 id="name-informative-references">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BCP219">[BCP219]</dt>
        <dd>
<div class="refInstance">Best Current Practice 219, <span>&lt;<a href="https://www.rfc-editor.org/info/bcp219">https://www.rfc-editor.org/info/bcp219</a>&gt;</span>.<br><span>At the time of writing, this BCP comprises the following:</span>
</div>
<div class="refInstance" id="RFC9499">
            <span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">K. Fujiwara</span>, <span class="refTitle">"DNS Terminology"</span>, <span class="seriesInfo">BCP 219</span>, <span class="seriesInfo">RFC 9499</span>, <span class="seriesInfo">DOI 10.17487/RFC9499</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9499">https://www.rfc-editor.org/info/rfc9499</a>&gt;</span>. </div>
</dd>
<dd class="break"></dd>
<dt id="I-D.tapril-ns2">[I-D.tapril-ns2]</dt>
        <dd>
<span class="refAuthor">April, T.</span>, <span class="refTitle">"Parameterized Nameserver Delegation with NS2 and NS2T"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tapril-ns2-01</span>, <time datetime="2020-07-13" class="refDate">13 July 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-tapril-ns2-01">https://datatracker.ietf.org/doc/html/draft-tapril-ns2-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3597">[RFC3597]</dt>
        <dd>
<span class="refAuthor">Gustafsson, A.</span>, <span class="refTitle">"Handling of Unknown DNS Resource Record (RR) Types"</span>, <span class="seriesInfo">RFC 3597</span>, <span class="seriesInfo">DOI 10.17487/RFC3597</span>, <time datetime="2003-09" class="refDate">September 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3597">https://www.rfc-editor.org/rfc/rfc3597</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4001">[RFC4001]</dt>
        <dd>
<span class="refAuthor">Daniele, M.</span>, <span class="refAuthor">Haberman, B.</span>, <span class="refAuthor">Routhier, S.</span>, and <span class="refAuthor">J. Schoenwaelder</span>, <span class="refTitle">"Textual Conventions for Internet Network Addresses"</span>, <span class="seriesInfo">RFC 4001</span>, <span class="seriesInfo">DOI 10.17487/RFC4001</span>, <time datetime="2005-02" class="refDate">February 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4001">https://www.rfc-editor.org/rfc/rfc4001</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5952">[RFC5952]</dt>
        <dd>
<span class="refAuthor">Kawamura, S.</span> and <span class="refAuthor">M. Kawashima</span>, <span class="refTitle">"A Recommendation for IPv6 Address Text Representation"</span>, <span class="seriesInfo">RFC 5952</span>, <span class="seriesInfo">DOI 10.17487/RFC5952</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5952">https://www.rfc-editor.org/rfc/rfc5952</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="appendix-A">
      <h2 id="name-examples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<div id="example-root">
<section id="appendix-A.1">
        <h3 id="name-root-zone-file">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-root-zone-file" class="section-name selfRef">Root zone file</a>
        </h3>
<p id="appendix-A.1-1">The following example shows an excerpt from a signed root zone.
It shows the delegation point for "example." and "test."<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">The "example." delegation has DELEG and NS records.
The "test." delegation has DELEG but no NS records.<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1-3">TODO: Add examples that have server-name and include-delegi being sets of more than one name.<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<p id="appendix-A.1-4">TODO: Examples that show DELEGI records in ns2.example.net and ns3.example.org.<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-5">
<pre>
example.   DELEG server-ipv4=192.0.2.1 server-ipv6=2001:DB8::1
example.   DELEG server-name=ns2.example.net.,ns3.example.org.
example.   RRSIG DELEG 13 1 300 20260101000000 (
                        20250101000000 33333 . SigExampleDELEG/ )

example.   NS    a.example.
example.   NS    b.example.net.
example.   NS    c.example.org.

example.   DS    44444 13 2 ABCDEF01234567...
example.   RRSIG DS 13 1 300 20260101000000 (
                        20250101000000 33333 . SigExampleDS )

example.   NSEC  net. NS DS RRSIG NSEC DELEG
example.   RRSIG NSEC 13 1 300 20260101000000 (
                        20250101000000 33333 . SigExampleNSEC+/ )

; unsigned glue for legacy (NS) delegation
; it is NOT present in NSEC chain
a.example. A     192.0.2.1
a.example. AAAA  2001:DB8::1
</pre><a href="#appendix-A.1-5" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-6">The "test." delegation point has a DELEG record and no NS or DS records.<a href="#appendix-A.1-6" class="pilcrow">¶</a></p>
<p id="appendix-A.1-7">Please note:
This is an example of unnecessarily complicated setup to demonstrate capabilities of DELEG and DELEGI RR types.<a href="#appendix-A.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-8">
<pre>
test.      DELEG server-ipv6=3fff::33
test.      DELEG include-delegi=Acfg.example.org.
test.      DELEG include-delegi=config2.example.net.
test.      RRSIG DELEG 13 1 300 20260101000000 (
                        20250101000000 33333 . SigTestDELEG )

test.      NSEC  . RRSIG NSEC DELEG
test.      RRSIG NSEC 13 1 300 20260101000000 (
                        20250101000000 33333 . SigTestNSEC/ )

; a forgotten glue from legacy (NS) delegation
; it is NOT present in NSEC chain and it is occluded
a.test.    A     192.0.2.1
</pre><a href="#appendix-A.1-8" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-9">Delegations to org and net zones omitted for brevity.<a href="#appendix-A.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="exampleorg-zone-file">
<section id="appendix-A.2">
        <h3 id="name-exampleorg-zone-file">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-exampleorg-zone-file" class="section-name selfRef">Example.org zone file</a>
        </h3>
<p id="appendix-A.2-1">The following example shows an excerpt from an unsigned example.org zone.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-2">
<pre>
Acfg.example.org.    DELEGI server-ipv6=2001:DB8::6666
Acfg.example.org.    DELEGI server-name=c.example.org.
Acfg.example.org.    DELEGI include-delegi=subcfg.example.org.

c.example.org.       AAAA   3fff::33

subcfg.example.org.  DELEGI server-ipv4=203.0.113.1 server-ipv6=3fff::2
</pre><a href="#appendix-A.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="examplenet-zone-file">
<section id="appendix-A.3">
        <h3 id="name-examplenet-zone-file">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-examplenet-zone-file" class="section-name selfRef">Example.net zone file</a>
        </h3>
<p id="appendix-A.3-1">The following example shows an excerpt from an unsigned example.net zone.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3-2">
<pre>
b.example.net.       A      198.51.100.1

config2.example.net. DELEGI server-name=b.example.org.
</pre><a href="#appendix-A.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="responses">
<section id="appendix-A.4">
        <h3 id="name-responses">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-responses" class="section-name selfRef">Responses</a>
        </h3>
<p id="appendix-A.4-1">The following sections show referral examples:<a href="#appendix-A.4-1" class="pilcrow">¶</a></p>
<div id="do-bit-clear-de-bit-clear">
<section id="appendix-A.4.1">
          <h4 id="name-do-bit-clear-de-bit-clear">
<a href="#appendix-A.4.1" class="section-number selfRef">A.4.1. </a><a href="#name-do-bit-clear-de-bit-clear" class="section-name selfRef">DO bit clear, DE bit clear</a>
          </h4>
<div id="query-for-fooexample">
<section id="appendix-A.4.1.1">
            <h5 id="name-query-for-fooexample">
<a href="#appendix-A.4.1.1" class="section-number selfRef">A.4.1.1. </a><a href="#name-query-for-fooexample" class="section-name selfRef">Query for foo.example</a>
            </h5>
<div class="alignLeft art-text artwork" id="appendix-A.4.1.1-1">
<pre>
;; Header: QR RCODE=NOERROR
;;

;; Question
foo.example.  IN MX

;; Answer
;; (empty)

;; Authority
example.   NS    a.example.
example.   NS    b.example.net.
example.   NS    c.example.org.

;; Additional
a.example. A     192.0.2.1
a.example. AAAA  2001:DB8::1
</pre><a href="#appendix-A.4.1.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="query-for-footest">
<section id="appendix-A.4.1.2">
            <h5 id="name-query-for-footest">
<a href="#appendix-A.4.1.2" class="section-number selfRef">A.4.1.2. </a><a href="#name-query-for-footest" class="section-name selfRef">Query for foo.test</a>
            </h5>
<div class="alignLeft art-text artwork" id="appendix-A.4.1.2-1">
<pre>
;; Header: QR AA RCODE=NXDOMAIN
;;

;; Question
foo.test.   IN MX

;; Answer
;; (empty)

;; Authority
.   SOA ...

;; Additional
;; OPT with Extended DNS Error: New Delegation Only
</pre><a href="#appendix-A.4.1.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="query-for-atest">
<section id="appendix-A.4.1.3">
            <h5 id="name-query-for-atest">
<a href="#appendix-A.4.1.3" class="section-number selfRef">A.4.1.3. </a><a href="#name-query-for-atest" class="section-name selfRef">Query for a.test</a>
            </h5>
<p id="appendix-A.4.1.3-1">A forgotten glue record under the "test." delegation point is occluded by DELEG RRset.<a href="#appendix-A.4.1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.1.3-2">
<pre>
;; Header: QR AA RCODE=NXDOMAIN
;;

;; Question
a.test.   IN A

;; Answer
;; (empty)

;; Authority
.   SOA ...

;; Additional
;; OPT with Extended DNS Error: New Delegation Only
</pre><a href="#appendix-A.4.1.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="do-bit-set-de-bit-clear">
<section id="appendix-A.4.2">
          <h4 id="name-do-bit-set-de-bit-clear">
<a href="#appendix-A.4.2" class="section-number selfRef">A.4.2. </a><a href="#name-do-bit-set-de-bit-clear" class="section-name selfRef">DO bit set, DE bit clear</a>
          </h4>
<div id="query-for-fooexample-1">
<section id="appendix-A.4.2.1">
            <h5 id="name-query-for-fooexample-2">
<a href="#appendix-A.4.2.1" class="section-number selfRef">A.4.2.1. </a><a href="#name-query-for-fooexample-2" class="section-name selfRef">Query for foo.example</a>
            </h5>
<div class="alignLeft art-text artwork" id="appendix-A.4.2.1-1">
<pre>
;; Header: QR DO RCODE=NOERROR
;;

;; Question
foo.example.   IN MX

;; Answer
;; (empty)

;; Authority

example.   NS    a.example.
example.   NS    b.example.net.
example.   NS    c.example.org.
example.   DS    44444 13 2 ABCDEF01234567...
example.   RRSIG DS 13 1 300 20260101000000 (
                        20250101000000 33333 . SigExampleDS )
;; Additional
a.example. A     192.0.2.1
a.example. AAAA  2001:DB8::1
</pre><a href="#appendix-A.4.2.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="legacynxdomain">
<section id="appendix-A.4.2.2">
            <h5 id="name-query-for-footest-2">
<a href="#appendix-A.4.2.2" class="section-number selfRef">A.4.2.2. </a><a href="#name-query-for-footest-2" class="section-name selfRef">Query for foo.test</a>
            </h5>
<div class="alignLeft art-text artwork" id="appendix-A.4.2.2-1">
<pre>
;; Header: QR DO AA RCODE=NXDOMAIN
;;

;; Question
foo.test.      IN MX

;; Answer
;; (empty)

;; Authority
.          SOA ...
.          RRSIG SOA ...
test.      NSEC  . RRSIG NSEC DELEG
test.      RRSIG NSEC 13 1 300 20260101000000 (
                        20250101000000 33333 . SigTestNSEC/ )

;; Additional
;; OPT with Extended DNS Error: New Delegation Only
</pre><a href="#appendix-A.4.2.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-occluded">
<section id="appendix-A.4.2.3">
            <h5 id="name-query-for-atest-2">
<a href="#appendix-A.4.2.3" class="section-number selfRef">A.4.2.3. </a><a href="#name-query-for-atest-2" class="section-name selfRef">Query for a.test</a>
            </h5>
<p id="appendix-A.4.2.3-1">A forgotten glue record under the "test." delegation point is occluded by DELEG RRset.
This is indicated by NSEC chain which "skips" over the owner name with A RRset.<a href="#appendix-A.4.2.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.2.3-2">
<pre>
;; Header: QR DO AA RCODE=NXDOMAIN
;;

;; Question
a.test.      IN A

;; Answer
;; (empty)

;; Authority
.          SOA ...
.          RRSIG SOA ...
test.      NSEC  . RRSIG NSEC DELEG
test.      RRSIG NSEC 13 1 300 20260101000000 (
                        20250101000000 33333 . SigTestNSEC/ )

;; Additional
;; OPT with Extended DNS Error: New Delegation Only
</pre><a href="#appendix-A.4.2.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="do-bit-clear-de-bit-set">
<section id="appendix-A.4.3">
          <h4 id="name-do-bit-clear-de-bit-set">
<a href="#appendix-A.4.3" class="section-number selfRef">A.4.3. </a><a href="#name-do-bit-clear-de-bit-set" class="section-name selfRef">DO bit clear, DE bit set</a>
          </h4>
<div id="query-for-fooexample-2">
<section id="appendix-A.4.3.1">
            <h5 id="name-query-for-fooexample-3">
<a href="#appendix-A.4.3.1" class="section-number selfRef">A.4.3.1. </a><a href="#name-query-for-fooexample-3" class="section-name selfRef">Query for foo.example</a>
            </h5>
<div class="alignLeft art-text artwork" id="appendix-A.4.3.1-1">
<pre>
;; Header: QR DE RCODE=NOERROR
;;

;; Question
foo.example.  IN MX

;; Answer
;; (empty)

;; Authority
example.   DELEG server-ipv4=192.0.2.1 server-ipv6=2001:DB8::1
example.   DELEG server-name=ns2.example.net.,ns3.example.org.

;; Additional
;; (empty)
</pre><a href="#appendix-A.4.3.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="query-for-footest-1">
<section id="appendix-A.4.3.2">
            <h5 id="name-query-for-footest-3">
<a href="#appendix-A.4.3.2" class="section-number selfRef">A.4.3.2. </a><a href="#name-query-for-footest-3" class="section-name selfRef">Query for foo.test</a>
            </h5>
<div class="alignLeft art-text artwork" id="appendix-A.4.3.2-1">
<pre>
;; Header: QR AA RCODE=NOERROR
;;

;; Question
foo.test.   IN MX

;; Answer
;; (empty)

;; Authority
test.      DELEG server-ipv6=3fff::33
test.      DELEG include-delegi=Acfg.example.org.
test.      DELEG include-delegi=config2.example.net.

;; Additional
;; (empty)
</pre><a href="#appendix-A.4.3.2-1" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.3.2-2">Follow-up example in <a href="#delegi-example" class="auto internal xref">Appendix A.5</a> explains ultimate meaning of this response.<a href="#appendix-A.4.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="do-bit-set-de-bit-set">
<section id="appendix-A.4.4">
          <h4 id="name-do-bit-set-de-bit-set">
<a href="#appendix-A.4.4" class="section-number selfRef">A.4.4. </a><a href="#name-do-bit-set-de-bit-set" class="section-name selfRef">DO bit set, DE bit set</a>
          </h4>
<div id="query-for-fooexample-3">
<section id="appendix-A.4.4.1">
            <h5 id="name-query-for-fooexample-4">
<a href="#appendix-A.4.4.1" class="section-number selfRef">A.4.4.1. </a><a href="#name-query-for-fooexample-4" class="section-name selfRef">Query for foo.example</a>
            </h5>
<div class="alignLeft art-text artwork" id="appendix-A.4.4.1-1">
<pre>
;; Header: QR DO DE RCODE=NOERROR
;;

;; Question
foo.example.  IN MX

;; Answer
;; (empty)

;; Authority
example.   DELEG server-ipv4=192.0.2.1 server-ipv6=2001:DB8::1
example.   DELEG server-name=ns2.example.net.,ns3.example.org.
example.   RRSIG DELEG 13 1 300 20260101000000 (
                        20250101000000 33333 . SigExampleDELEG/ )
example.   DS    44444 13 2 ABCDEF01234567...
example.   RRSIG DS 13 1 300 20260101000000 (
                        20250101000000 33333 . SigExampleDS )

;; Additional
a.example. A     192.0.2.1
a.example. AAAA  2001:DB8::1
</pre><a href="#appendix-A.4.4.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="query-for-footest-2">
<section id="appendix-A.4.4.2">
            <h5 id="name-query-for-footest-4">
<a href="#appendix-A.4.4.2" class="section-number selfRef">A.4.4.2. </a><a href="#name-query-for-footest-4" class="section-name selfRef">Query for foo.test</a>
            </h5>
<div class="alignLeft art-text artwork" id="appendix-A.4.4.2-1">
<pre>
;; Header: QR DO DE AA RCODE=NOERROR
;;

;; Question
foo.test.      IN MX

;; Answer
;; (empty)

;; Authority
test.      DELEG server-ipv6=3fff::33
test.      DELEG include-delegi=Acfg.example.org.
test.      DELEG include-delegi=config2.example.net.
test.      RRSIG DELEG 13 1 300 20260101000000 (
                        20250101000000 33333 . SigTestDELEG )
test.      NSEC  . RRSIG NSEC DELEG
test.      RRSIG NSEC 13 1 300 20260101000000 (
                        20250101000000 33333 . SigTestNSEC/ )

;; Additional
;; (empty)
</pre><a href="#appendix-A.4.4.2-1" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.4.2-2">Follow-up example in <a href="#delegi-example" class="auto internal xref">Appendix A.5</a> explains the ultimate meaning of this response.<a href="#appendix-A.4.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="delegi-example">
<section id="appendix-A.5">
        <h3 id="name-delegi-interpretation">
<a href="#appendix-A.5" class="section-number selfRef">A.5. </a><a href="#name-delegi-interpretation" class="section-name selfRef">DELEGI Interpretation</a>
        </h3>
<p id="appendix-A.5-1">In the examples above, the test. DELEG record uses indirection and points to other domain names with DELEGI, A, and AAAA records.
During resolution, a resolver will gradually build set of name servers to contact, as defined in <a href="#slist" class="auto internal xref">Section 3.1.6</a>.<a href="#appendix-A.5-1" class="pilcrow">¶</a></p>
<p id="appendix-A.5-2">To visualize end result of this process we represent full set of name servers in form of a 'virtual' DELEG RRset.<a href="#appendix-A.5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.5-3">
<pre>
test. DELEG server-ipv4=198.51.100.1
test. DELEG server-ipv4=203.0.113.1
test. DELEG server-ipv6=2001:DB8::6666
test. DELEG server-ipv6=3fff::2
; IPv6 address 3fff::33 was de-duplicated (input RRsets listed it twice)
test. DELEG server-ipv6=3fff::33
</pre><a href="#appendix-A.5-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A.5-4">Implementations are free to use arbitrary representation for this data as it is not directly exposed via DNS protocol.<a href="#appendix-A.5-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">This document is heavily based on past work done by Tim April in
<span>[<a href="#I-D.tapril-ns2" class="cite xref">I-D.tapril-ns2</a>]</span> and thus extends the thanks to the people helping on this which are:
John Levine, Erik Nygren, Jon Reed, Ben Kaduk, Mashooq Muhaimen, Jason Moreau, Jerrod Wiesman, Billy Tiemann, Gordon Marx and Brian Wellington.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">Work on DELEG protocol has started at IETF 118 Hackaton.
Hackaton participants: Christian Elmerot, David Blacka, David Lawrence, Edward Lewis, Erik Nygren, George Michaelson, Jan Včelák, Klaus Darilion, Libor Peltan, Manu Bretelle, Peter van Dijk, Petr Špaček, Philip Homburg, Ralf Weber, Roy Arends, Shane Kerr, Shumon Huque, Vandan Adhvaryu, Vladimír Čunát, Andreas Schulze.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">Other people joined the effort after the initial hackaton: Ben Schwartz, Bob Halley, Paul Hoffman, Miek Gieben ...<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<p id="appendix-B-4">RESINFO extension was contributed by Florian Obser.<a href="#appendix-B-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tim April</span></div>
<div dir="auto" class="left"><span class="org">Google, LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ietf@tapril.net" class="email">ietf@tapril.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Petr Špaček</span></div>
<div dir="auto" class="left"><span class="org">ISC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:pspacek@isc.org" class="email">pspacek@isc.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ralf Weber</span></div>
<div dir="auto" class="left"><span class="org">Akamai Technologies</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rweber@akamai.com" class="email">rweber@akamai.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David C Lawrence</span></div>
<div dir="auto" class="left"><span class="org">Salesforce</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tale@dd.org" class="email">tale@dd.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
